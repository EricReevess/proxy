<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../../default.css">
    <title>CanvasClock</title>
    <style>
        body {
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .box{
            width:250px;
            height:250px;
        }
    </style>
    <script>
        window.onload = function() {
            /** @type {HTMLCanvasElement} */
            let drawing = document.querySelector("#drawing");
            const pi = Math.PI;
            if (drawing.getContext) {
                let ctx = drawing.getContext("2d");
                setInterval(function() {
                    let date = new Date();
                    let ms = date.getMilliseconds();
                    let sec = date.getSeconds() + ms / 1000;
                    let min = date.getMinutes() + sec / 60;
                    let hour = (date.getHours() + min / 60) % 12;

                    ctx.save();

                    ctx.translate(250, 250);
                    ctx.scale(1.5, 1.5);

                    ctx.clearRect(-100, -100, 200, 200)

                    //渲染内圆
                    ctx.save();
                    ctx.lineWidth = 5
                    ctx.strokeStyle = "#dfe4ea"
                    ctx.beginPath();
                    ctx.arc(0, 0, 100, 0, 2 * pi)
                    ctx.stroke();
                    ctx.restore()



                    //渲染外圆
                    ctx.save();
                    ctx.lineWidth = 10
                    ctx.strokeStyle = "#a4b0be"
                    ctx.beginPath();
                    ctx.arc(0, 0, 107, 0, 2 * pi)
                    ctx.stroke();
                    ctx.restore()

                    // 渲染刻度
                    ctx.save();
                    ctx.strokeStyle = "#57606f"
                    for (let i = 1; i < 61; i++) {
                        ctx.rotate(6 * pi / 180)
                        ctx.beginPath();
                        if (i % 5 == 0) {
                            ctx.lineWidth = 3
                        } else {
                            ctx.lineWidth = 1;
                        }
                        ctx.moveTo(0, -92)
                        ctx.lineTo(0, -98);
                        ctx.stroke();

                    }
                    ctx.restore()


                    //渲染数字
                    ctx.save();
                    ctx.font = " 20px Arial"
                    ctx.textAlign = "center";
                    ctx.fillStyle = "#353b48"
                    ctx.textBaseline = "middle";
                    for (let i = 1; i <= 12; i++) {
                        ctx.fillText(i.toString(), getPoint(i * 30).x, getPoint(i * 30).y + 2)
                    }
                    ctx.restore();



                    //渲染时针
                    ctx.save();
                    let hourDeg = 180;
                    //let flag = false
                    ctx.strokeStyle = "#34495e";
                    ctx.lineWidth = 5;
                    //setInterval(function() {
                    // if (deg % 360 == 0) {
                    //     flag = !flag;
                    // }
                    // ctx.save()
                    // if (flag) {
                    //     ctx.strokeStyle = "#000"
                    // } else {
                    //     ctx.strokeStyle = "#fff"
                    // }
                    ctx.rotate(30 * hour * pi / 180);
                    ctx.beginPath();
                    ctx.moveTo(0, 15);
                    ctx.lineTo(0, -60);
                    ctx.stroke();
                    ctx.restore();
                    //}, 1000 / 60)


                    // 渲染分针
                    ctx.save();
                    let minDeg = 45;
                    ctx.lineWidth = 3;
                    ctx.strokeStyle = "#34495e";
                    ctx.rotate(6 * min * pi / 180);
                    ctx.beginPath();
                    ctx.moveTo(0, 15);
                    ctx.lineTo(0, -70);
                    ctx.stroke();
                    ctx.restore();

                    // 渲染秒针
                    ctx.save();
                    let secDeg = 90;
                    ctx.lineWidth = 2;
                    ctx.strokeStyle = "#ff7979";
                    ctx.rotate(6 * sec * pi / 180);
                    ctx.beginPath();
                    ctx.moveTo(0, 20);
                    ctx.lineTo(0, -85);
                    ctx.stroke();
                    ctx.restore();

                    //渲染针座
                    ctx.save()
                    ctx.lineWidth = 4;
                    ctx.strokeStyle = "#34495e";
                    ctx.beginPath()
                    ctx.arc(0, 0, 4, 0, 2 * pi)
                    ctx.stroke();
                    ctx.restore();

                    ctx.save()
                    ctx.fillStyle = "#ff7979";
                    ctx.beginPath()
                    ctx.arc(0, 0, 3.5, 0, 2 * pi)
                    ctx.fill();
                    ctx.restore();

                    ctx.save()
                    ctx.fillStyle = "#f5f6fa";
                    ctx.beginPath()
                    ctx.arc(0, 0, 1.5, 0, 2 * pi)
                    ctx.fill();
                    ctx.restore();

                    ctx.restore()
                }, 1000 / 60)
            }
            //获得圆弧点坐标函数
            getPoint = (deg) => {
                let edge = 82;
                let x = Math.round(edge * Math.sin(deg * Math.PI / 180))
                let y = Math.round(edge * Math.cos(deg * Math.PI / 180))
                return {
                    x: x,
                    y: -y
                }
            }
        }
    </script>
</head>

<body>
    <div class="box">
    <canvas id="drawing" width="500px" height="500px"></canvas>
    </div>
</body>

</html>
